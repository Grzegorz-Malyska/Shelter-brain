{"ast":null,"code":"import _defineProperty from \"/home/gjm/Pulpit/Shelter-brain/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/home/gjm/Pulpit/Shelter-brain/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/gjm/Pulpit/Shelter-brain/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/gjm/Pulpit/Shelter-brain/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/gjm/Pulpit/Shelter-brain/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/gjm/Pulpit/Shelter-brain/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/gjm/Pulpit/Shelter-brain/frontend/src/components/other_crud/AddAnimalForm.js\";\nimport React from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport DismissableAlert from \"../../utils/DismissableAlert\";\nimport axios from \"axios\";\nimport Config from \"../../Config\";\n\nvar AddAnimalForm =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(AddAnimalForm, _React$Component);\n\n  function AddAnimalForm() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, AddAnimalForm);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(AddAnimalForm)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      name: \"\",\n      age: -1,\n      gender: \"MALE\",\n      // default checked\n      base64PngImage: \"\",\n      errorMessage: null\n    };\n\n    _this.onAddAnimal = function (e) {\n      e.preventDefault();\n      var jwt = sessionStorage.getItem(\"jwt\");\n      e.target.reset();\n      axios.post(\"\".concat(Config.AJAX_BASE_URL, \"/animals\"), {\n        name: _this.state.name,\n        age: Number(_this.state.age),\n        gender: _this.state.gender,\n        base64Image: _this.state.base64PngImage\n      }, {\n        headers: {\n          \"x-auth\": jwt\n        }\n      }).then(function () {\n        return _this.props.onAddAnimal();\n      }).catch(function (err) {\n        if (err.response !== undefined && err.response.status === 401) {\n          // JWT expired (probably server restart)\n          sessionStorage.removeItem(\"jwt\");\n\n          _this.props.history.push(\"/\");\n        } else {\n          _this.setState({\n            errorMessage: err.response !== undefined ? err.response.data : \"Brak połączenia z serwerem\"\n          });\n        }\n      });\n    };\n\n    _this.genericOnChangeEventHandler = function (e) {\n      return _this.setState(_defineProperty({}, e.target.name, e.target.value));\n    };\n\n    _this.genericOnChangeCheckboxesEventHandler = function (e) {\n      if (e.target.checked) {\n        _this.setState(_defineProperty({}, e.target.name, e.target.value));\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(AddAnimalForm, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var jwt = sessionStorage.getItem(\"jwt\");\n\n      if (jwt === null) {\n        this.props.history.push(\"/\");\n      }\n\n      var randomValueForId = Math.round(Math.random() * 100);\n      return React.createElement(\"div\", {\n        style: {\n          padding: \"20px\",\n          border: \"4px black solid\",\n          borderRadius: \"8px\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62\n        },\n        __self: this\n      }, \"Dodaj nowe zwierz\\u0105tko\"), React.createElement(\"form\", {\n        onSubmit: this.onAddAnimal,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"name_\".concat(randomValueForId),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65\n        },\n        __self: this\n      }, \"Nazwa\"), React.createElement(\"input\", {\n        type: \"text\",\n        name: \"name\",\n        className: \"form-control\",\n        id: \"name_\".concat(randomValueForId),\n        onChange: this.genericOnChangeEventHandler,\n        required: true,\n        placeholder: \"Wpisz nazw\\u0119/imi\\u0119 zwierzaka...\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"age_\".concat(randomValueForId),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      }, \"Wiek\"), React.createElement(\"input\", {\n        type: \"number\",\n        min: \"1\",\n        max: \"100\",\n        name: \"age\",\n        className: \"form-control\",\n        id: \"age_\".concat(randomValueForId),\n        onChange: this.genericOnChangeEventHandler,\n        required: true,\n        placeholder: \"Wpisz wiek zwierzaka...\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      })), React.createElement(\"fieldset\", {\n        className: \"form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }, React.createElement(\"legend\", {\n        className: \"col-form-label pt-0\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      }, \"P\\u0142e\\u0107\"), React.createElement(\"div\", {\n        className: \"form-check\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        className: \"form-check-input\",\n        type: \"radio\",\n        name: \"gender\",\n        onChange: this.genericOnChangeCheckboxesEventHandler,\n        id: \"gender_male_\".concat(randomValueForId),\n        value: \"MALE\",\n        checked: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }), React.createElement(\"label\", {\n        className: \"form-check-label\",\n        htmlFor: \"gender_male_\".concat(randomValueForId),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79\n        },\n        __self: this\n      }, \"M\\u0119ska\")), React.createElement(\"div\", {\n        className: \"form-check\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        className: \"form-check-input\",\n        type: \"radio\",\n        name: \"gender\",\n        onChange: this.genericOnChangeCheckboxesEventHandler,\n        id: \"gender_female_\".concat(randomValueForId),\n        value: \"FEMALE\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82\n        },\n        __self: this\n      }), React.createElement(\"label\", {\n        className: \"form-check-label\",\n        htmlFor: \"gender_female_\".concat(randomValueForId),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }, \"\\u017Be\\u0144ska\"))), React.createElement(\"div\", {\n        className: \"form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"animal_image_\".concat(randomValueForId),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }, \"Wybierz zdj\\u0119cie zwierzaka\"), React.createElement(\"input\", {\n        required: true,\n        type: \"file\",\n        className: \"form-control-file\",\n        id: \"animal_image_\".concat(randomValueForId),\n        accept: \"image/png\",\n        onChange: function onChange(e) {\n          var file = e.target.files[0];\n\n          if (file.type !== \"image/png\") {\n            _this2.setState({\n              errorMessage: \"Z\\u0142y format zdj\\u0119cia profilowego (\".concat(file.type, \" zamiast png)\")\n            });\n\n            e.target.value = \"\";\n            return;\n          }\n\n          var fileReader = new FileReader();\n          fileReader.readAsBinaryString(file);\n\n          fileReader.onload = function () {\n            return _this2.setState({\n              base64PngImage: btoa(fileReader.result)\n            });\n          };\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      })), React.createElement(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }, \"Dodaj\"), this.state.errorMessage !== null && React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }, React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }), React.createElement(DismissableAlert, {\n        key: Math.random(),\n        color: \"danger\",\n        timeout: 3,\n        toggle: function toggle() {\n          return _this2.setState({\n            errorMessage: null\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, this.state.errorMessage))));\n    }\n  }]);\n\n  return AddAnimalForm;\n}(React.Component);\n\nexport default withRouter(AddAnimalForm);","map":{"version":3,"sources":["/home/gjm/Pulpit/Shelter-brain/frontend/src/components/other_crud/AddAnimalForm.js"],"names":["React","withRouter","DismissableAlert","axios","Config","AddAnimalForm","state","name","age","gender","base64PngImage","errorMessage","onAddAnimal","e","preventDefault","jwt","sessionStorage","getItem","target","reset","post","AJAX_BASE_URL","Number","base64Image","headers","then","props","catch","err","response","undefined","status","removeItem","history","push","setState","data","genericOnChangeEventHandler","value","genericOnChangeCheckboxesEventHandler","checked","randomValueForId","Math","round","random","padding","border","borderRadius","file","files","type","fileReader","FileReader","readAsBinaryString","onload","btoa","result","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport {withRouter} from \"react-router-dom\";\nimport DismissableAlert from \"../../utils/DismissableAlert\";\nimport axios from \"axios\";\nimport Config from \"../../Config\";\n\nclass AddAnimalForm extends React.Component {\n    state = {\n        name: \"\",\n        age: -1,\n        gender: \"MALE\",         // default checked\n        base64PngImage: \"\",\n\n        errorMessage: null\n    }\n\n    onAddAnimal = e => {\n        e.preventDefault();\n\n        const jwt = sessionStorage.getItem(\"jwt\");\n        e.target.reset();\n        \n        axios.post(`${Config.AJAX_BASE_URL}/animals`, {\n            name: this.state.name,\n            age: Number(this.state.age),\n            gender: this.state.gender,\n            base64Image: this.state.base64PngImage\n        }, {\n            headers: {\n                \"x-auth\": jwt\n            }\n        })\n            .then(() => this.props.onAddAnimal())\n            .catch(err => {\n                if(err.response !== undefined && err.response.status === 401) {\n                    // JWT expired (probably server restart)\n                    sessionStorage.removeItem(\"jwt\");\n                    this.props.history.push(\"/\");\n                } else {\n                    this.setState({errorMessage: err.response !== undefined ? err.response.data : \"Brak połączenia z serwerem\"});\n                }\n            });\n    };\n\n    genericOnChangeEventHandler = e => this.setState({[e.target.name]: e.target.value});\n    genericOnChangeCheckboxesEventHandler = e => {\n        if(e.target.checked) {\n            this.setState({[e.target.name]: e.target.value});\n        }\n    }\n\n    render() {\n        const jwt = sessionStorage.getItem(\"jwt\");\n        if(jwt === null) {\n            this.props.history.push(\"/\");\n        }\n\n        const randomValueForId = Math.round(Math.random() * 100);\n\n        return (\n            <div style={{padding: \"20px\", border: \"4px black solid\", borderRadius: \"8px\"}}>\n                <h3>Dodaj nowe zwierzątko</h3>\n                <form onSubmit={this.onAddAnimal}>\n                    <div className=\"form-group\">\n                        <label htmlFor={`name_${randomValueForId}`}>Nazwa</label>\n                        <input type=\"text\" name=\"name\" className=\"form-control\" id={`name_${randomValueForId}`} onChange={this.genericOnChangeEventHandler}\n                            required={true} placeholder=\"Wpisz nazwę/imię zwierzaka...\" />\n                            </div>\n                    <div className=\"form-group\">\n                        <label htmlFor={`age_${randomValueForId}`}>Wiek</label>\n                        <input type=\"number\" min=\"1\" max=\"100\" name=\"age\" className=\"form-control\" id={`age_${randomValueForId}`} onChange={this.genericOnChangeEventHandler}\n                            required={true} placeholder=\"Wpisz wiek zwierzaka...\" />\n                    </div>\n                    <fieldset className=\"form-group\">\n                            <legend className=\"col-form-label pt-0\">Płeć</legend>\n                            <div className=\"form-check\">\n                                <input className=\"form-check-input\" type=\"radio\" name=\"gender\"\n                                    onChange={this.genericOnChangeCheckboxesEventHandler} id={`gender_male_${randomValueForId}`} value=\"MALE\" checked={true} />\n                                <label className=\"form-check-label\" htmlFor={`gender_male_${randomValueForId}`}>Męska</label>\n                            </div>\n                            <div className=\"form-check\">\n                                <input className=\"form-check-input\" type=\"radio\" name=\"gender\"\n                                    onChange={this.genericOnChangeCheckboxesEventHandler} id={`gender_female_${randomValueForId}`} value=\"FEMALE\" />\n                                <label className=\"form-check-label\" htmlFor={`gender_female_${randomValueForId}`}>Żeńska</label>\n                            </div>\n                    </fieldset>\n                    <div className=\"form-group\">\n                        <label htmlFor={`animal_image_${randomValueForId}`}>Wybierz zdjęcie zwierzaka</label>\n                        <input required={true} type=\"file\" className=\"form-control-file\" id={`animal_image_${randomValueForId}`}\n                            accept=\"image/png\" onChange={e => {\n                                const file = e.target.files[0];\n\n                                if(file.type !== \"image/png\") {\n                                    this.setState({errorMessage: `Zły format zdjęcia profilowego (${file.type} zamiast png)`});\n                                    e.target.value = \"\";\n                                    return;\n                                }\n\n                                const fileReader = new FileReader();\n                                fileReader.readAsBinaryString(file);\n                                fileReader.onload = () => this.setState({base64PngImage: btoa(fileReader.result)});\n                            }}/>\n                    </div>\n                    <button type=\"submit\" className=\"btn btn-primary\">Dodaj</button>\n\n                    {this.state.errorMessage !== null &&\n                        <div>\n                            <br />\n                            <br />\n                            <DismissableAlert key={Math.random()} color=\"danger\" timeout={3} toggle={() => this.setState({errorMessage: null})}>\n                                {this.state.errorMessage}\n                            </DismissableAlert>\n                        </div>\n                    }\n                </form>\n            </div>\n        );\n    }\n}\n\nexport default withRouter(AddAnimalForm);\n"]},"metadata":{},"sourceType":"module"}