{"ast":null,"code":"import _classCallCheck from \"/home/gjm/Pulpit/Shelter-brain/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/gjm/Pulpit/Shelter-brain/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/gjm/Pulpit/Shelter-brain/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/gjm/Pulpit/Shelter-brain/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/gjm/Pulpit/Shelter-brain/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/gjm/Pulpit/Shelter-brain/frontend/src/pages/ProfilePage.js\";\nimport React from \"react\";\nimport ShelterReportPanel from \"../components/report/ShelterReportPanel\";\nimport { withRouter } from \"react-router-dom\";\nimport { Container, Row, Col, Navbar, NavbarBrand, Nav, NavItem } from \"reactstrap\";\nimport LogoutButton from \"../components/auth/LogoutButton\";\nimport axios from \"axios\";\nimport DismissableAlert from \"../utils/DismissableAlert\";\nimport AddAnimalForm from \"../components/other_crud/AddAnimalForm\";\nimport PersonalAccountProfile from \"../components/PersonalAccountProfile\";\nimport Config from \"../Config\";\n\nvar ProfilePage =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ProfilePage, _React$Component);\n\n  function ProfilePage() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ProfilePage);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ProfilePage)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      errorMessage: null,\n      account: null\n    };\n\n    _this.onDelete = function (animalToDelete) {\n      var jwt = sessionStorage.getItem(\"jwt\");\n      axios.delete(\"\".concat(Config.AJAX_BASE_URL, \"/animals/\").concat(animalToDelete.id), {\n        headers: {\n          \"x-auth\": jwt\n        }\n      }).then(function () {\n        return _this.forceUpdate();\n      }).catch(function (err) {\n        if (err.response !== undefined && err.response.status === 401) {\n          // JWT expired (probably server restart)\n          sessionStorage.removeItem(\"jwt\");\n\n          _this.props.history.push(\"/\");\n        } else {\n          _this.setState({\n            errorMessage: err.response !== undefined ? err.response.data : \"Brak połączenia z serwerem\"\n          });\n        }\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(ProfilePage, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var jwt = sessionStorage.getItem(\"jwt\");\n\n      if (jwt === null) {\n        this.props.history.push(\"/\");\n      }\n\n      axios.get(\"\".concat(Config.AJAX_BASE_URL, \"/account\"), {\n        headers: {\n          \"x-auth\": jwt\n        }\n      }).then(function (res) {\n        return _this2.setState({\n          account: res.data\n        });\n      }).catch(function (err) {\n        if (err.response !== undefined && err.response.status === 401) {\n          // JWT expired (probably server restart)\n          sessionStorage.removeItem(\"jwt\");\n\n          _this2.props.history.push(\"/\");\n        } else {\n          _this2.setState({\n            errorMessage: err.response !== undefined ? err.response.data : \"Brak połączenia z serwerem\",\n            account: null\n          });\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var jwt = sessionStorage.getItem(\"jwt\");\n\n      if (jwt === null) {\n        this.props.history.push(\"/\");\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72\n        },\n        __self: this\n      }, React.createElement(Navbar, {\n        color: \"light\",\n        light: true,\n        expand: \"md\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73\n        },\n        __self: this\n      }, React.createElement(NavbarBrand, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }, \"Centrala schroniska\"), React.createElement(Nav, {\n        className: \"ml-auto\",\n        navbar: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      }, React.createElement(NavItem, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76\n        },\n        __self: this\n      }, React.createElement(LogoutButton, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      })))), React.createElement(Container, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82\n        },\n        __self: this\n      }, React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83\n        },\n        __self: this\n      }, React.createElement(Col, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      }, \"Panel pracownika schroniska\"), this.state.account !== null && React.createElement(PersonalAccountProfile, {\n        account: this.state.account,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }), React.createElement(ShelterReportPanel, {\n        key: Math.random(),\n        privileged: true,\n        onDelete: this.onDelete,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }), this.state.errorMessage !== null && React.createElement(DismissableAlert, {\n        key: Math.random(),\n        color: \"danger\",\n        timeout: 3,\n        toggle: function toggle() {\n          return _this3.setState({\n            errorMessage: null\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91\n        },\n        __self: this\n      }, this.state.errorMessage))), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }), React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      }, React.createElement(Col, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }, React.createElement(AddAnimalForm, {\n        onAddAnimal: function onAddAnimal() {\n          return _this3.forceUpdate();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }))), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return ProfilePage;\n}(React.Component);\n\nexport default withRouter(ProfilePage);","map":{"version":3,"sources":["/home/gjm/Pulpit/Shelter-brain/frontend/src/pages/ProfilePage.js"],"names":["React","ShelterReportPanel","withRouter","Container","Row","Col","Navbar","NavbarBrand","Nav","NavItem","LogoutButton","axios","DismissableAlert","AddAnimalForm","PersonalAccountProfile","Config","ProfilePage","state","errorMessage","account","onDelete","animalToDelete","jwt","sessionStorage","getItem","delete","AJAX_BASE_URL","id","headers","then","forceUpdate","catch","err","response","undefined","status","removeItem","props","history","push","setState","data","get","res","Math","random","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport ShelterReportPanel from \"../components/report/ShelterReportPanel\";\nimport {withRouter} from \"react-router-dom\";\nimport {Container, Row, Col, Navbar, NavbarBrand, Nav, NavItem} from \"reactstrap\";\nimport LogoutButton from \"../components/auth/LogoutButton\";\nimport axios from \"axios\";\nimport DismissableAlert from \"../utils/DismissableAlert\";\nimport AddAnimalForm from \"../components/other_crud/AddAnimalForm\"\nimport PersonalAccountProfile from \"../components/PersonalAccountProfile\";\nimport Config from \"../Config\";\n\nclass ProfilePage extends React.Component {\n    state = {\n        errorMessage: null,\n\n        account: null\n    };\n\n    onDelete = animalToDelete => {\n        const jwt = sessionStorage.getItem(\"jwt\");\n        \n        axios.delete(`${Config.AJAX_BASE_URL}/animals/${animalToDelete.id}`, {\n            headers: {\n                \"x-auth\": jwt\n            }\n        })\n            .then(() => this.forceUpdate())\n            .catch(err => {\n                if(err.response !== undefined && err.response.status === 401) {\n                    // JWT expired (probably server restart)\n                    sessionStorage.removeItem(\"jwt\");\n                    this.props.history.push(\"/\");\n                } else {\n                    this.setState({errorMessage: err.response !== undefined ? err.response.data : \"Brak połączenia z serwerem\"});\n                }\n            });\n    };\n\n    componentDidMount() {\n        const jwt = sessionStorage.getItem(\"jwt\");\n        if(jwt === null) {\n            this.props.history.push(\"/\");\n        }\n\n        axios.get(`${Config.AJAX_BASE_URL}/account`, {\n            headers: {\n                \"x-auth\": jwt\n            }\n        })\n            .then(res => this.setState({account: res.data}))\n            .catch(err => {\n                if(err.response !== undefined && err.response.status === 401) {\n                    // JWT expired (probably server restart)\n                    sessionStorage.removeItem(\"jwt\");\n                    this.props.history.push(\"/\");\n                } else {\n                    this.setState({\n                        errorMessage: err.response !== undefined ? err.response.data : \"Brak połączenia z serwerem\",\n                        account: null\n                    });\n                }\n            });\n    }\n\n    render() {\n        const jwt = sessionStorage.getItem(\"jwt\");\n        if(jwt === null) {\n            this.props.history.push(\"/\");\n        }\n\n        return (\n            <div>\n                <Navbar color=\"light\" light expand=\"md\">\n                    <NavbarBrand>Centrala schroniska</NavbarBrand>\n                    <Nav className=\"ml-auto\" navbar>\n                        <NavItem>\n                            <LogoutButton />\n                        </NavItem>\n                    </Nav>\n                </Navbar>\n\n                <Container>\n                    <Row>\n                        <Col>\n                            <h1 className=\"text-center\">Panel pracownika schroniska</h1>\n                            {this.state.account !== null && <PersonalAccountProfile account={this.state.account} />}\n                            <br />\n                            <ShelterReportPanel key={Math.random()} privileged={true} onDelete={this.onDelete} />\n                            <br />\n                            {this.state.errorMessage !== null &&\n                                <DismissableAlert key={Math.random()} color=\"danger\" timeout={3} toggle={() => this.setState({errorMessage: null})}>\n                                    {this.state.errorMessage}\n                                </DismissableAlert>}\n                        </Col>\n                    </Row>\n                    <br />\n                    <br />\n                    <Row>\n                        <Col>\n                              <AddAnimalForm onAddAnimal={() => this.forceUpdate()} />\n                        </Col>\n                    </Row>\n                    <br />\n                </Container>\n            </div>\n        );\n    }\n}\n\nexport default withRouter(ProfilePage);\n"]},"metadata":{},"sourceType":"module"}